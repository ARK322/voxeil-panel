apiVersion: v1
kind: ConfigMap
metadata:
  name: backup-scripts
  namespace: backup
data:
  run.sh: |
    #!/usr/bin/env sh
    set -eu
    TS="$(date -u +%Y%m%dT%H%M%SZ)"
    OUT="/backups/sites/_infra/${TS}"
    mkdir -p "${OUT}"
    echo "backup-runner OK at ${TS}" > "${OUT}/status.txt"
    echo "Namespaces:" > "${OUT}/namespaces.txt"
    kubectl get ns -o name >> "${OUT}/namespaces.txt"
